{
  "hash": "08a6dd42c3c4271d3aea4e34fbb35693",
  "result": {
    "markdown": "---\ntitle: \"Exploring Relationships of Variables in Sleep Data\"\nauthor: \"Edun Joshua\"\ndate: \"2023-11-18\"\ncategories: [stats, causal regression modelling]\nimage: \"image.jpg\"\n---\n\n\n# Introduction\n\n![](image/TempEmbed_(1).jpg){fig-alt=\"cover image\" fig-align=\"center\"}\n\nThe variable of interests are quality_of_sleep and sleep_disorder\n\nThe goal is to build a casual model using linear regression that explains quality of sleep, and logistic regression to explain sleep disorders\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.3.2\n```\n:::\n\n```{.r .cell-code}\n# descriptives\nlibrary(datawizard)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'datawizard' was built under R version 4.3.2\n```\n:::\n\n```{.r .cell-code}\nlibrary(kableExtra)\nlibrary(skimr)\nlibrary(qqplotr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'qqplotr' was built under R version 4.3.2\n```\n:::\n\n```{.r .cell-code}\n# os\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'here' was built under R version 4.3.2\n```\n:::\n:::\n\n\n# Data\n\nWe will be using data from a fictitious...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsleep <- here(\"data/sleep.csv\") %>% read_csv(show_col_types = F) %>% janitor::clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# checking the data\nhead(sleep) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> person_id </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:left;\"> occupation </th>\n   <th style=\"text-align:right;\"> sleep_duration </th>\n   <th style=\"text-align:right;\"> quality_of_sleep </th>\n   <th style=\"text-align:right;\"> physical_activity_level </th>\n   <th style=\"text-align:right;\"> stress_level </th>\n   <th style=\"text-align:left;\"> bmi_category </th>\n   <th style=\"text-align:left;\"> blood_pressure </th>\n   <th style=\"text-align:right;\"> heart_rate </th>\n   <th style=\"text-align:right;\"> daily_steps </th>\n   <th style=\"text-align:left;\"> sleep_disorder </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> Software Engineer </td>\n   <td style=\"text-align:right;\"> 6.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> Overweight </td>\n   <td style=\"text-align:left;\"> 126/83 </td>\n   <td style=\"text-align:right;\"> 77 </td>\n   <td style=\"text-align:right;\"> 4200 </td>\n   <td style=\"text-align:left;\"> None </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Doctor </td>\n   <td style=\"text-align:right;\"> 6.2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Normal </td>\n   <td style=\"text-align:left;\"> 125/80 </td>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:left;\"> None </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Doctor </td>\n   <td style=\"text-align:right;\"> 6.2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Normal </td>\n   <td style=\"text-align:left;\"> 125/80 </td>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:left;\"> None </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Sales Representative </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Sleep Apnea </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Sales Representative </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Sleep Apnea </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Software Engineer </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Insomnia </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# shape of data\nnrow(sleep)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 374\n```\n:::\n\n```{.r .cell-code}\nncol(sleep)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 13\n```\n:::\n\n```{.r .cell-code}\nnames(sleep)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"person_id\"               \"gender\"                 \n [3] \"age\"                     \"occupation\"             \n [5] \"sleep_duration\"          \"quality_of_sleep\"       \n [7] \"physical_activity_level\" \"stress_level\"           \n [9] \"bmi_category\"            \"blood_pressure\"         \n[11] \"heart_rate\"              \"daily_steps\"            \n[13] \"sleep_disorder\"         \n```\n:::\n:::\n\n\n## Data cleaning\n\nI observed the following issues in the data\n\n-   Occupation variable having levels with very few counts. Those with few counts can be consolidated with similar categories.\n\n-   The BMI category variable has both \"Normal\" and \"Normal Weight\" as levels. This is most likely as data entry error.\n\n-   The heart rate variable is not in a suitable format to work with. I'll extract the systolic blood pressure from the variable as an integer. I would not need the diastolic blood pressure as I observed strong multicollinearity between both diastolic and systolic blood pressure.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# observe occupations with low frequency counts\nggplot(sleep, aes(occupation))+geom_bar() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# observe data entry error in bmi_category variable\nggplot(sleep, aes(bmi_category))+geom_bar() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# regrouping occupation variable so that occupations with lower counts are consolidated with other similar occupations. Simultaneously correcting data entry error in bmi_category variable\nsleep <- sleep %>% mutate( \n  occupation=ifelse(sleep$occupation %in% c(\"Software Engineer\", \"Scientist\", \"Engineer\"),\"Technical\", \nifelse(sleep$occupation %in% c(\"Salesperson\", \"Sales Representative\", \"Manager\"), \"Sales\", ifelse(sleep$occupation %in% c(\"Doctor\", \"Nurse\"), \"Medical\",\n                                                          as.character(occupation)))),\nbmi_category = ifelse(sleep$bmi_category %in% c(\"Normal\", \"Normal Weight\"), \"Normal\", as.character(sleep$bmi_category)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# extracting systolic blood pressure from the blood_pressure variable as it such a numeric variable is easier to work with. Subsequently dropping hear_rate variable\n\nsleep <- sleep %>% mutate(\nbp_sys= parse_number(str_sub(sleep$blood_pressure, 1, 3)),\nperson_id = as.character(person_id)\n) %>% select(!heart_rate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# confirming changes\nhead(sleep) %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> person_id </th>\n   <th style=\"text-align:left;\"> gender </th>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:left;\"> occupation </th>\n   <th style=\"text-align:right;\"> sleep_duration </th>\n   <th style=\"text-align:right;\"> quality_of_sleep </th>\n   <th style=\"text-align:right;\"> physical_activity_level </th>\n   <th style=\"text-align:right;\"> stress_level </th>\n   <th style=\"text-align:left;\"> bmi_category </th>\n   <th style=\"text-align:left;\"> blood_pressure </th>\n   <th style=\"text-align:right;\"> daily_steps </th>\n   <th style=\"text-align:left;\"> sleep_disorder </th>\n   <th style=\"text-align:right;\"> bp_sys </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> Technical </td>\n   <td style=\"text-align:right;\"> 6.1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> Overweight </td>\n   <td style=\"text-align:left;\"> 126/83 </td>\n   <td style=\"text-align:right;\"> 4200 </td>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:right;\"> 126 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Medical </td>\n   <td style=\"text-align:right;\"> 6.2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Normal </td>\n   <td style=\"text-align:left;\"> 125/80 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:right;\"> 125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Medical </td>\n   <td style=\"text-align:right;\"> 6.2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Normal </td>\n   <td style=\"text-align:left;\"> 125/80 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n   <td style=\"text-align:left;\"> None </td>\n   <td style=\"text-align:right;\"> 125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Sales </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Sleep Apnea </td>\n   <td style=\"text-align:right;\"> 140 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Sales </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Sleep Apnea </td>\n   <td style=\"text-align:right;\"> 140 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> Technical </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:left;\"> 140/90 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:left;\"> Insomnia </td>\n   <td style=\"text-align:right;\"> 140 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# confirming changes to BMI category variable\nggplot(sleep, aes(bmi_category))+geom_bar() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# confirming changes to occupation variable\nggplot(sleep, aes(occupation))+geom_bar() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n# Summary statistics\n\nWe are going to explore summary statistics particularly for our variables of interest\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# General statistics\nsleep %>% skim() %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> skim_type </th>\n   <th style=\"text-align:left;\"> skim_variable </th>\n   <th style=\"text-align:right;\"> n_missing </th>\n   <th style=\"text-align:right;\"> complete_rate </th>\n   <th style=\"text-align:right;\"> character.min </th>\n   <th style=\"text-align:right;\"> character.max </th>\n   <th style=\"text-align:right;\"> character.empty </th>\n   <th style=\"text-align:right;\"> character.n_unique </th>\n   <th style=\"text-align:right;\"> character.whitespace </th>\n   <th style=\"text-align:right;\"> numeric.mean </th>\n   <th style=\"text-align:right;\"> numeric.sd </th>\n   <th style=\"text-align:right;\"> numeric.p0 </th>\n   <th style=\"text-align:right;\"> numeric.p25 </th>\n   <th style=\"text-align:right;\"> numeric.p50 </th>\n   <th style=\"text-align:right;\"> numeric.p75 </th>\n   <th style=\"text-align:right;\"> numeric.p100 </th>\n   <th style=\"text-align:left;\"> numeric.hist </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> person_id </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 374 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> gender </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> occupation </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> bmi_category </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> blood_pressure </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> character </td>\n   <td style=\"text-align:left;\"> sleep_disorder </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 42.184492 </td>\n   <td style=\"text-align:right;\"> 8.6731335 </td>\n   <td style=\"text-align:right;\"> 27.0 </td>\n   <td style=\"text-align:right;\"> 35.25 </td>\n   <td style=\"text-align:right;\"> 43.0 </td>\n   <td style=\"text-align:right;\"> 50.0 </td>\n   <td style=\"text-align:right;\"> 59.0 </td>\n   <td style=\"text-align:left;\"> ▆▆▇▃▅ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 7.132086 </td>\n   <td style=\"text-align:right;\"> 0.7956567 </td>\n   <td style=\"text-align:right;\"> 5.8 </td>\n   <td style=\"text-align:right;\"> 6.40 </td>\n   <td style=\"text-align:right;\"> 7.2 </td>\n   <td style=\"text-align:right;\"> 7.8 </td>\n   <td style=\"text-align:right;\"> 8.5 </td>\n   <td style=\"text-align:left;\"> ▇▆▇▇▆ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 7.312834 </td>\n   <td style=\"text-align:right;\"> 1.1969559 </td>\n   <td style=\"text-align:right;\"> 4.0 </td>\n   <td style=\"text-align:right;\"> 6.00 </td>\n   <td style=\"text-align:right;\"> 7.0 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n   <td style=\"text-align:left;\"> ▁▇▆▇▅ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 59.171123 </td>\n   <td style=\"text-align:right;\"> 20.8308037 </td>\n   <td style=\"text-align:right;\"> 30.0 </td>\n   <td style=\"text-align:right;\"> 45.00 </td>\n   <td style=\"text-align:right;\"> 60.0 </td>\n   <td style=\"text-align:right;\"> 75.0 </td>\n   <td style=\"text-align:right;\"> 90.0 </td>\n   <td style=\"text-align:left;\"> ▇▇▇▇▇ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 5.385027 </td>\n   <td style=\"text-align:right;\"> 1.7745264 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 4.00 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 7.0 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:left;\"> ▇▃▂▃▃ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> daily_steps </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 6816.844920 </td>\n   <td style=\"text-align:right;\"> 1617.9156791 </td>\n   <td style=\"text-align:right;\"> 3000.0 </td>\n   <td style=\"text-align:right;\"> 5600.00 </td>\n   <td style=\"text-align:right;\"> 7000.0 </td>\n   <td style=\"text-align:right;\"> 8000.0 </td>\n   <td style=\"text-align:right;\"> 10000.0 </td>\n   <td style=\"text-align:left;\"> ▁▅▇▆▂ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> bp_sys </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 128.553476 </td>\n   <td style=\"text-align:right;\"> 7.7481176 </td>\n   <td style=\"text-align:right;\"> 115.0 </td>\n   <td style=\"text-align:right;\"> 125.00 </td>\n   <td style=\"text-align:right;\"> 130.0 </td>\n   <td style=\"text-align:right;\"> 135.0 </td>\n   <td style=\"text-align:right;\"> 142.0 </td>\n   <td style=\"text-align:left;\"> ▆▅▇▂▅ </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Measures of spread\nsleep %>% describe_distribution() %>%  as_tibble() %>%  select(Variable, Skewness, SD, Kurtosis) %>% kable(digits=2) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> Skewness </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Kurtosis </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.26 </td>\n   <td style=\"text-align:right;\"> 8.67 </td>\n   <td style=\"text-align:right;\"> -0.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.80 </td>\n   <td style=\"text-align:right;\"> -1.29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> -0.21 </td>\n   <td style=\"text-align:right;\"> 1.20 </td>\n   <td style=\"text-align:right;\"> -0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 20.83 </td>\n   <td style=\"text-align:right;\"> -1.27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 1.77 </td>\n   <td style=\"text-align:right;\"> -1.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> daily_steps </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 1617.92 </td>\n   <td style=\"text-align:right;\"> -0.39 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> bp_sys </td>\n   <td style=\"text-align:right;\"> -0.04 </td>\n   <td style=\"text-align:right;\"> 7.75 </td>\n   <td style=\"text-align:right;\"> -0.89 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Main Analyses\n\n## Associations\n\n### Research Question: \"What strong associations exists between quality_of_sleep and other variables in the dataset?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# | warning: false\n# | message: false\n# packages required for associations\nlibrary(correlation)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'correlation' was built under R version 4.3.2\n```\n:::\n\n```{.r .cell-code}\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GGally' was built under R version 4.3.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plotting the grid plot of scatterplots of numeric variables\nggscatmat(sleep %>% select_if(is.numeric)) + theme_light()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The dot-dot notation (`..scaled..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(scaled)` instead.\nℹ The deprecated feature was likely used in the GGally package.\n  Please report the issue at <https://github.com/ggobi/ggally/issues>.\n```\n:::\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# showing relationships with strong correlations (greater than |+-0.4|)\ncorrelates_tib <- sleep |> \n  select(where(is.numeric)) |> \n  correlation() %>% as.tibble() %>% select(!c(CI:df_error,Method,n_Obs)) %>% filter(abs(r) > 0.4) %>% arrange(r) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `as.tibble()` was deprecated in tibble 2.0.0.\nℹ Please use `as_tibble()` instead.\nℹ The signature and semantics have changed, see `?as_tibble`.\n```\n:::\n\n```{.r .cell-code}\ncorrelates_tib %>% kable(digits=3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Parameter1 </th>\n   <th style=\"text-align:left;\"> Parameter2 </th>\n   <th style=\"text-align:right;\"> r </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.899 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.811 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.422 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 0.474 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:left;\"> bp_sys </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:left;\"> daily_steps </td>\n   <td style=\"text-align:right;\"> 0.773 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 0.883 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# robust correlation analysis since the data are skewed. Results is filtered to include only relationships involving quality_of_sleep. Sorted ascendingly by p-value\ncorrelates_tib <- sleep |> \n  select(where(is.numeric)) |> \n  correlation(method=\"percentage\") %>% as.tibble() %>% select(!c(CI:df_error,Method,n_Obs))  %>% arrange(p)  %>% filter( Parameter1 == \"quality_of_sleep\" | Parameter2 == \"quality_of_sleep\") %>% arrange(p) %>% filter(p < 0.05)\ncorrelates_tib %>% kable(digits=3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Parameter1 </th>\n   <th style=\"text-align:left;\"> Parameter2 </th>\n   <th style=\"text-align:right;\"> r </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.910 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 0.892 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 0.432 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Results\n\nThe most significant relationships (at alpha = .05) are the relationships between:\n\n1.  quality of sleep and stress level, *r*(372) =-0.91, *p* \\< 0.0001\n2.  quality of sleep and sleep duration, *r*(372) = 0.89, *p* \\< 0.0001\n3.  quality of sleep and age, *r*(372) =0.43, *p* \\< 0.0001\n4.  quality of sleep and physical activity level, *r*(372) =0.18, *p* = 0.0054\n\nThese are the variables we would fit to our linear regression model.\n\n# Fitting a GLM\n\n### Research Question: \"Which GLM model best explains quality of sleep\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# importing needed packages\nlibrary(BayesFactor)\nlibrary(ggfortify)\nlibrary(parameters)\nlibrary(robust)\nlibrary(broom)\n```\n:::\n\n\n![GLM Workflow](dsr2_fig_08_12_glm_process.png){fig-align=\"center\"}\n\n### Initial Checks (Linearity)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatmat(sleep, columns=c(\"stress_level\", \"sleep_duration\",\"age\", \"physical_activity_level\",\"quality_of_sleep\"))\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n#### **Interpretation**\n\nLooking at the bottom row of the plots, we see the scatterplot of all the variables against quality_of_sleep on the y_axis.\n\nThe four predictors have reasonably linear relationships with the sleep quality and there are no obvious outliers (except maybe in the bottom left of the scatterplot with band image). Across the diagonal, we see the distributions of scores. None of the variables have a normal distribution, exhibiting various degrees of modality.\n\nIf we look only at the predictors, then the highest correlation is between sleep duration and stress level which is significant at the 0.0001 level (*r* = -0.81). Focussing on the outcome variable, of all of the predictors, stress level and sleep duration correlate best with the outcome (*r*s = -0.9 and 0.88 respectively).\n\n### One predictor model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_lm_01 <- lm(data=sleep, formula = quality_of_sleep ~ stress_level)\n\n# checking model fit\nglance(qs_lm_01) %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.808 </td>\n   <td style=\"text-align:right;\"> 0.807 </td>\n   <td style=\"text-align:right;\"> 0.526 </td>\n   <td style=\"text-align:right;\"> 1563.033 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> -289.06 </td>\n   <td style=\"text-align:right;\"> 584.121 </td>\n   <td style=\"text-align:right;\"> 595.893 </td>\n   <td style=\"text-align:right;\"> 102.735 </td>\n   <td style=\"text-align:right;\"> 372 </td>\n   <td style=\"text-align:right;\"> 374 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nStress level accounts for 80.8% of the variation in quality of sleep.\n\nTherefore, we can say that adding the predictor of **stress_level** significantly improved the fit of the model to the data compared to having no predictors in the model, *F*(1, 372) = 1563.03, *p* \\< .001\n\n#### Model parameters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(qs_lm_01, conf.int = T) %>% kable(digits=3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 10.577 </td>\n   <td style=\"text-align:right;\"> 0.087 </td>\n   <td style=\"text-align:right;\"> 121.678 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 10.406 </td>\n   <td style=\"text-align:right;\"> 10.748 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.606 </td>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> -39.535 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> -0.636 </td>\n   <td style=\"text-align:right;\"> -0.576 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIf stress level increases by 1 point, quality_of_sleep reduces by more than half a point. This estimate is significant (p \\< 0.0000001). With the chance of being wrong 5% of the time, our estimate is going to be somewhere in the range \\[-0.636, -0.576\\]. This confidence interval does not cross zero, so we can be sure that a real effect exists.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summary of the model parameters and fit\nsummary(qs_lm_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = quality_of_sleep ~ stress_level, data = sleep)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7276 -0.1525  0.2413  0.2724  1.0600 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  10.57739    0.08693  121.68   <2e-16 ***\nstress_level -0.60623    0.01533  -39.53   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5255 on 372 degrees of freedom\nMultiple R-squared:  0.8078,\tAdjusted R-squared:  0.8072 \nF-statistic:  1563 on 1 and 372 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### Multiple predictors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_lm_02 <- lm(quality_of_sleep ~ stress_level+sleep_duration+age+physical_activity_level, data=sleep)\n# fit statistics\nglance(qs_lm_02) %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> r.squared </th>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> logLik </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> deviance </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> nobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.892 </td>\n   <td style=\"text-align:right;\"> 0.891 </td>\n   <td style=\"text-align:right;\"> 0.395 </td>\n   <td style=\"text-align:right;\"> 762.735 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> -181.05 </td>\n   <td style=\"text-align:right;\"> 374.1 </td>\n   <td style=\"text-align:right;\"> 397.645 </td>\n   <td style=\"text-align:right;\"> 57.66 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 374 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe % of variance explained by the predictors increased to 89% from our previous value of 81%.\n\nIn other words, sleep duration, age and physical activity level account for an additional 89% - 80.8% = 8.2% of the variance in quality of sleep. The difference between the $R^2$ and the adjusted $R^2$ is 0.8921-0.8909= 0.0012. Which means if the model were derived from the population rather than a sample we'd conclude that it accounted for approximately 0.12% less variance in the outcome.\n\n#### Model parameter estimates\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(qs_lm_02, conf.int=T) %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 3.957 </td>\n   <td style=\"text-align:right;\"> 0.439 </td>\n   <td style=\"text-align:right;\"> 9.023 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3.095 </td>\n   <td style=\"text-align:right;\"> 4.819 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.351 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n   <td style=\"text-align:right;\"> -16.466 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> -0.392 </td>\n   <td style=\"text-align:right;\"> -0.309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:right;\"> 0.621 </td>\n   <td style=\"text-align:right;\"> 0.046 </td>\n   <td style=\"text-align:right;\"> 13.372 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.529 </td>\n   <td style=\"text-align:right;\"> 0.712 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 5.180 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.019 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 3.796 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   Stress level : For every unit increase in stress level, quality of sleep reduces by 0.35 points. This interpretation is true only if the other variables are held constant.\n\n-   Sleep duration: For every unit increase in sleep duration, quality of sleep increases by 0.62 points. This interpretation is true only if the other variables are held constant.\n\n-   Age: For one year difference in the age of respondents, quality of sleep increases by 0.01 points. This interpretation is true only if the other variables are held constant.\n\n-   Physical activity level: For every unit increase in sleep duration, quality of sleep increases by 0.004 points. This interpretation is true only if the other variables are held constant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# standardized betas\nmodel_parameters(qs_lm_02, standardize=\"refit\") %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Parameter </th>\n   <th style=\"text-align:right;\"> Coefficient </th>\n   <th style=\"text-align:right;\"> SE </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> CI_low </th>\n   <th style=\"text-align:right;\"> CI_high </th>\n   <th style=\"text-align:right;\"> t </th>\n   <th style=\"text-align:right;\"> df_error </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> -0.034 </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> -0.520 </td>\n   <td style=\"text-align:right;\"> 0.032 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> -0.582 </td>\n   <td style=\"text-align:right;\"> -0.458 </td>\n   <td style=\"text-align:right;\"> -16.466 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:right;\"> 0.413 </td>\n   <td style=\"text-align:right;\"> 0.031 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.352 </td>\n   <td style=\"text-align:right;\"> 0.473 </td>\n   <td style=\"text-align:right;\"> 13.372 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n   <td style=\"text-align:right;\"> 0.019 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.062 </td>\n   <td style=\"text-align:right;\"> 0.137 </td>\n   <td style=\"text-align:right;\"> 5.180 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 0.106 </td>\n   <td style=\"text-align:right;\"> 3.796 </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# generating standard deviations to interpret standardised betas\nsleep %>% select(stress_level, age, sleep_duration, physical_activity_level, quality_of_sleep) %>% skim() %>% as_tibble() %>% select(skim_variable, numeric.sd) %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> skim_variable </th>\n   <th style=\"text-align:right;\"> numeric.sd </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> stress_level </td>\n   <td style=\"text-align:right;\"> 1.775 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 8.673 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sleep_duration </td>\n   <td style=\"text-align:right;\"> 0.796 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 20.831 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep </td>\n   <td style=\"text-align:right;\"> 1.197 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n-   Stress level : As the stress level increases by 1 standard deviation (1.77 points), quality of sleep reduces by 0.52 standard deviations (0.52 × 1.197) = 0.622 points. This estimate is significant at alpha = .001 level. This interpretation is true only if the effects of airplay and advertising are held constant.\n\n-   Sleep duration: As the sleep duration increases by 1 standard deviation (0.8 points), quality of sleep increases by 0.41 standard deviations (0.41 × 1.197) = 0.491 points. This estimate is significant at alpha = .001 level. This interpretation is true only if the effects of airplay and advertising are held constant.\n\n-   Age: As age increases by 1 standard deviation (8.67 years), quality of sleep increases by 0.10 standard deviations (0.10 × 1.197) = 0.12 points. This estimate is significant at alpha = .001 level. This interpretation is true only if the effects of airplay and advertising are held constant.\n\n-   Physical activity level: As the physical activity level increases by 1 standard deviation (20.83 points), quality of sleep increases by 0.07 standard deviations (0.07 × 1.197) = 0.08 points. This estimate is significant at alpha = .001 level. This interpretation is true only if the effects of airplay and advertising are held constant.\n\n### Comparing models\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(qs_lm_01, qs_lm_02) %>% tidy() %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> df.residual </th>\n   <th style=\"text-align:right;\"> rss </th>\n   <th style=\"text-align:right;\"> df </th>\n   <th style=\"text-align:right;\"> sumsq </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep ~ stress_level </td>\n   <td style=\"text-align:right;\"> 372 </td>\n   <td style=\"text-align:right;\"> 102.735 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> quality_of_sleep ~ stress_level + sleep_duration + age + physical_activity_level </td>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 57.660 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 45.076 </td>\n   <td style=\"text-align:right;\"> 96.155 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe can say that ***qs_lm_02*** significantly improved the fit of the model to the data compared to ***qs_lm_01***, *F*(3, 369) = 96.16, *p* \\< .001.\n\n### Model diagnostics\n\n#### Linearity and homoscedasticity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(qs_lm_02, which = c(1, 3),\n                  colour = \"#5c97bf\",\n                  smooth.colour = \"#ef4836\",\n                  size = 1.5) + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nLinearity assumption is violated\n\n#### Normality assumption\n\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(qs_lm_02,\n                  which = 2,\n                  colour = \"#5c97bf\",\n                  smooth.colour = \"#ef4836\",\n      \n                  size = 1.5) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nNormality assumption is violated\n\n#### Outliers and Influential cases\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# outlier cases\nautoplot(qs_lm_02, which =  c(4:6))\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\nThere seems to be outliers in the data. Let's identify them in our dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_outliers <- qs_lm_02 |> \n  augment() |> \n  rowid_to_column(var = \"case_no\") |> \n  mutate(case_no = as.character(case_no)) %>% \n filter(abs(.std.resid) >= 3)|> \n arrange(.std.resid)\nqs_outliers %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> case_no </th>\n   <th style=\"text-align:right;\"> quality_of_sleep </th>\n   <th style=\"text-align:right;\"> stress_level </th>\n   <th style=\"text-align:right;\"> sleep_duration </th>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> physical_activity_level </th>\n   <th style=\"text-align:right;\"> .fitted </th>\n   <th style=\"text-align:right;\"> .resid </th>\n   <th style=\"text-align:right;\"> .hat </th>\n   <th style=\"text-align:right;\"> .sigma </th>\n   <th style=\"text-align:right;\"> .cooksd </th>\n   <th style=\"text-align:right;\"> .std.resid </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 81 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.8 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 5.348 </td>\n   <td style=\"text-align:right;\"> -1.348 </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n   <td style=\"text-align:right;\"> 0.032 </td>\n   <td style=\"text-align:right;\"> -3.433 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 82 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.8 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 5.348 </td>\n   <td style=\"text-align:right;\"> -1.348 </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:right;\"> 0.389 </td>\n   <td style=\"text-align:right;\"> 0.032 </td>\n   <td style=\"text-align:right;\"> -3.433 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 5.320 </td>\n   <td style=\"text-align:right;\"> -1.320 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.390 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> -3.365 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 5.320 </td>\n   <td style=\"text-align:right;\"> -1.320 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.390 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> -3.365 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 5.320 </td>\n   <td style=\"text-align:right;\"> -1.320 </td>\n   <td style=\"text-align:right;\"> 0.016 </td>\n   <td style=\"text-align:right;\"> 0.390 </td>\n   <td style=\"text-align:right;\"> 0.036 </td>\n   <td style=\"text-align:right;\"> -3.365 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 104 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 6.6 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 6.235 </td>\n   <td style=\"text-align:right;\"> -1.235 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.391 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n   <td style=\"text-align:right;\"> -3.138 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 106 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 6.6 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 6.235 </td>\n   <td style=\"text-align:right;\"> -1.235 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.391 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n   <td style=\"text-align:right;\"> -3.138 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 148 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 6.5 </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 6.234 </td>\n   <td style=\"text-align:right;\"> -1.234 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.391 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n   <td style=\"text-align:right;\"> -3.133 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# outlier cases\nqs_outliers %>% inner_join(sleep, by = join_by(case_no == person_id)) %>% select(c(1,7:24))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 19\n  case_no .fitted .resid    .hat .sigma .cooksd .std.resid gender age.y\n  <chr>     <dbl>  <dbl>   <dbl>  <dbl>   <dbl>      <dbl> <chr>  <dbl>\n1 81         5.35  -1.35 0.0133   0.389  0.0318      -3.43 Female    34\n2 82         5.35  -1.35 0.0133   0.389  0.0318      -3.43 Female    34\n3 4          5.32  -1.32 0.0156   0.390  0.0360      -3.36 Male      28\n4 5          5.32  -1.32 0.0156   0.390  0.0360      -3.36 Male      28\n5 6          5.32  -1.32 0.0156   0.390  0.0360      -3.36 Male      28\n6 104        6.23  -1.23 0.00904  0.391  0.0180      -3.14 Male      36\n7 106        6.23  -1.23 0.00904  0.391  0.0180      -3.14 Male      36\n8 148        6.23  -1.23 0.00722  0.391  0.0143      -3.13 Male      39\n# ℹ 10 more variables: occupation <chr>, sleep_duration.y <dbl>,\n#   quality_of_sleep.y <dbl>, physical_activity_level.y <dbl>,\n#   stress_level.y <dbl>, bmi_category <chr>, blood_pressure <chr>,\n#   daily_steps <dbl>, sleep_disorder <chr>, bp_sys <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# influential cases\nqs_outliers <- qs_lm_02 |> \n  augment() |> \n  rowid_to_column(var = \"case_no\") |> \n  mutate(case_no = as.character(case_no)) %>% \n filter(abs(.cooksd) > 1)|> \n arrange(.std.resid)\nqs_outliers\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 12\n# ℹ 12 variables: case_no <chr>, quality_of_sleep <dbl>, stress_level <dbl>,\n#   sleep_duration <dbl>, age <dbl>, physical_activity_level <dbl>,\n#   .fitted <dbl>, .resid <dbl>, .hat <dbl>, .sigma <dbl>, .cooksd <dbl>,\n#   .std.resid <dbl>\n```\n:::\n:::\n\n\nThere are no influential cases\n\n#### Assumption of Independence\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::durbinWatsonTest(qs_lm_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n lag Autocorrelation D-W Statistic p-value\n   1       0.4577484      1.083912       0\n Alternative hypothesis: rho != 0\n```\n:::\n:::\n\n\nSince the D-W statistic is not less than 1 or greater than 3, we can be fairly confident that this assumption is met.\n\n#### Assumptions of Multicollinearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::vif(qs_lm_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           stress_level          sleep_duration                     age \n               3.406796                3.256354                1.262757 \nphysical_activity_level \n               1.153822 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(car::vif(qs_lm_02))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.269932\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# tolerance\n1/car::vif(qs_lm_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           stress_level          sleep_duration                     age \n              0.2935310               0.3070919               0.7919178 \nphysical_activity_level \n              0.8666849 \n```\n:::\n:::\n\n\n> If the largest VIF is greater than 10 then there is cause for concern (Bowerman & O'Connell, 1990; Myers, 1990). If the average VIF is substantially greater than 1 then the regression may be biased (Bowerman & O'Connell, 1990). Tolerance below 0.1 indicates a serious problem. Tolerance below 0.2 indicates a potential problem (Menard, 1995).\n\nSince our average VIF is greater than 1, our model may be biased\n\n### Robust linear methods\n\nOur model appears to be accurate for the sample and but not necessarily generalizable to the population because of some GLM assumption violations. Time to use robust methods.\n\n#### Robust parameter estimates\n\nNow we check for the significance of the test of bias and we compare their corresponding coefficients.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_lm_rob <- lmRob(quality_of_sleep ~ stress_level+sleep_duration+age+physical_activity_level, data = sleep, na.action = na.exclude)\nsummary(qs_lm_rob)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlmRob(formula = quality_of_sleep ~ stress_level + sleep_duration + \n    age + physical_activity_level, data = sleep, na.action = na.exclude)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-1.105750 -0.034463  0.004544  0.572389  1.344101 \n\nCoefficients:\n                          Estimate Std. Error  t value Pr(>|t|)    \n(Intercept)              8.5862994  0.1278987   67.134  < 2e-16 ***\nstress_level            -0.5876346  0.0057227 -102.686  < 2e-16 ***\nsleep_duration           0.0989499  0.0137276    7.208 3.23e-12 ***\nage                      0.0060295  0.0006261    9.630  < 2e-16 ***\nphysical_activity_level  0.0138005  0.0003576   38.589  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1386 on 369 degrees of freedom\nMultiple R-Squared: 0.4484 \n\nTest for Bias:\n            statistic p-value\nM-estimate      13.08 0.02267\nLS-estimate     10.10 0.07233\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(qs_lm_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = quality_of_sleep ~ stress_level + sleep_duration + \n    age + physical_activity_level, data = sleep)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.34804 -0.26046  0.01664  0.24112  1.03722 \n\nCoefficients:\n                         Estimate Std. Error t value Pr(>|t|)    \n(Intercept)              3.957065   0.438560   9.023  < 2e-16 ***\nstress_level            -0.350549   0.021289 -16.466  < 2e-16 ***\nsleep_duration           0.620714   0.046420  13.372  < 2e-16 ***\nage                      0.013736   0.002652   5.180 3.66e-07 ***\nphysical_activity_level  0.004006   0.001055   3.796 0.000172 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3953 on 369 degrees of freedom\nMultiple R-squared:  0.8921,\tAdjusted R-squared:  0.8909 \nF-statistic: 762.7 on 4 and 369 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThere is reason to believe that our original model, qs_lm_02, is biased. First, the M-estimate is significant\n\n### Bayesian approaches\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_bf <- BayesFactor::regressionBF(quality_of_sleep ~ stress_level + sleep_duration + age + physical_activity_level, rscaleCont = \"medium\", data = sleep)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: data coerced from tibble to data frame\n```\n:::\n\n```{.r .cell-code}\nsummary(qs_bf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nBayes factor analysis\n--------------\n[1] stress_level                                                   : 1.238909e+131 ±0.01%\n[2] sleep_duration                                                 : 1.8428e+120   ±0.01%\n[3] age                                                            : 1.375858e+19  ±0%\n[4] physical_activity_level                                        : 104.9573      ±0.01%\n[5] stress_level + sleep_duration                                  : 4.33176e+165  ±0%\n[6] stress_level + age                                             : 1.669112e+134 ±0%\n[7] stress_level + physical_activity_level                         : 2.590168e+141 ±0%\n[8] sleep_duration + age                                           : 4.273726e+131 ±0%\n[9] sleep_duration + physical_activity_level                       : 6.433615e+118 ±0%\n[10] age + physical_activity_level                                 : 2.418886e+19  ±0%\n[11] stress_level + sleep_duration + age                           : 2.151821e+171 ±0%\n[12] stress_level + sleep_duration + physical_activity_level       : 6.037683e+168 ±0%\n[13] stress_level + age + physical_activity_level                  : 6.086042e+142 ±0%\n[14] sleep_duration + age + physical_activity_level                : 2.12722e+130  ±0%\n[15] stress_level + sleep_duration + age + physical_activity_level : 8.470484e+172 ±0%\n\nAgainst denominator:\n  Intercept only \n---\nBayes factor type: BFlinearModel, JZS\n```\n:::\n:::\n\n\nThe best model is model 15 since it has largest Bayes Factor of 8.47 \\* 10\\^42\n\n# Moderation and mediation analysis\n\n## Research questions:\n\n1.  *Is the relationship between sleep_duration and quality of sleep moderated by sleep disorder?*\n\n2.  *Is the relationship between stress level and quality of sleep moderated by occupation?*\n\n3.  *Is the relationship between physical activity and quality of sleep mediated by daily steps?*\n\n### Is the relationship between sleep duration and quality of sleep moderated by sleep disorder?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualizing the relationship of the three variables\nggplot(sleep, aes(x = sleep_duration, y = quality_of_sleep, color = sleep_disorder)) +\ngeom_jitter(size=1, alpha=0.8) +\nlabs(x = \"Sleep duration\", y = \"Quality of sleep\", color = \"Sleep disorder\") +\ngeom_smooth(method = \"lm\", se = FALSE, linewidth=0.9) + theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\nThe plot shows that there might be some moderation effects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# making sleep_disorder a factor variable and setting the base level to \"None\"\nsleep <- sleep %>% mutate(\n  sleep_disorder = as_factor(sleep_disorder) %>% fct_relevel(\"None\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_lm_03 <- lm(quality_of_sleep ~ sleep_duration * sleep_disorder, data=sleep)\nqs_lm_03 %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  term                                     estimate std.error statistic  p.value\n  <chr>                                       <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                                -0.575    0.367      -1.57 1.18e- 1\n2 sleep_duration                              1.11     0.0496     22.5  6.12e-71\n3 sleep_disorderSleep Apnea                  -3.43     0.577      -5.95 6.23e- 9\n4 sleep_disorderInsomnia                     -3.20     1.11       -2.88 4.19e- 3\n5 sleep_duration:sleep_disorderSleep Apnea    0.480    0.0800      6.00 4.63e- 9\n6 sleep_duration:sleep_disorderInsomnia       0.450    0.167       2.70 7.18e- 3\n```\n:::\n:::\n\n\n#### Interpretation\n\nThe effect of increasing sleep duration in someone with no sleep disorder on sleep quality is 1.11\n\nThe effect of sleep apnea on sleep quality compared to someone with no disorders is -3.43\n\nThe effect of Insomnia on sleep quality compared to someone with no disorders is -3.20\n\nThe effect of increasing sleep duration in someone with sleep anea on sleep quality compared to someone with no disorders is 0.48\n\nThe effect of increasing sleep duration in someone with insomnia on sleep quality compared to someone with no disorders is 0.45\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteractions::sim_slopes(\n  qs_lm_03,\n  pred = sleep_duration,\n  modx = sleep_disorder,\n  jnplot = TRUE,\n  robust = TRUE,\n  confint = TRUE\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Johnson-Neyman intervals are not available for factor moderators.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSIMPLE SLOPES ANALYSIS \n\nSlope of sleep_duration when sleep_disorder = Insomnia: \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  1.56   0.15   1.26    1.86    10.26   0.00\n\nSlope of sleep_duration when sleep_disorder = Sleep Apnea: \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  1.59   0.06   1.48    1.71    27.35   0.00\n\nSlope of sleep_duration when sleep_disorder = None: \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  1.11   0.03   1.05    1.17    36.50   0.00\n```\n:::\n:::\n\n\nThe slopes for the three regressions are not significantly different\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteractions::interact_plot(\n  qs_lm_03,\n  pred = sleep_duration,\n  modx = sleep_disorder,\n  interval = TRUE,\n  robust = TRUE,\n  legend.main = \"Sleep disorder\"\n  )\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\nLooking at the slope, we can that the moderation effect is not significant\n\n#### Conclusion\n\nSleep disorder is not a moderator of the relationship between sleep duration and quality of sleep\n\n### Is the relationship between stress level and quality of sleep moderated by occupation?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqs_lm_04 <- lm(quality_of_sleep ~ stress_level * occupation, data=sleep)\nqs_lm_04 %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 5\n   term                             estimate std.error statistic   p.value\n   <chr>                               <dbl>     <dbl>     <dbl>     <dbl>\n 1 (Intercept)                         9.37     0.225     41.7   2.85e-140\n 2 stress_level                       -0.321    0.0473    -6.79  4.62e- 11\n 3 occupationLawyer                    3.36     1.08       3.10  2.06e-  3\n 4 occupationMedical                   1.36     0.243      5.61  4.01e-  8\n 5 occupationSales                     3.55     1.03       3.45  6.19e-  4\n 6 occupationTeacher                  -0.284    0.333     -0.855 3.93e-  1\n 7 occupationTechnical                 2.06     0.260      7.94  2.56e- 14\n 8 stress_level:occupationLawyer      -0.634    0.214     -2.96  3.30e-  3\n 9 stress_level:occupationMedical     -0.285    0.0494    -5.77  1.68e-  8\n10 stress_level:occupationSales       -0.679    0.151     -4.51  8.78e-  6\n11 stress_level:occupationTeacher     -0.145    0.0709    -2.04  4.18e-  2\n12 stress_level:occupationTechnical   -0.472    0.0557    -8.47  6.42e- 16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninteractions::sim_slopes(\n  qs_lm_04,\n  pred = stress_level,\n  modx = occupation,\n  jnplot = TRUE,\n  robust = TRUE,\n  confint = TRUE\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Johnson-Neyman intervals are not available for factor moderators.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nSIMPLE SLOPES ANALYSIS \n\nSlope of stress_level when occupation = Lawyer: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -0.95   0.03   -1.02   -0.89   -29.71   0.00\n\nSlope of stress_level when occupation = Accountant: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -0.32   0.04   -0.40   -0.24    -7.92   0.00\n\nSlope of stress_level when occupation = Teacher: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -0.47   0.09   -0.65   -0.28    -5.01   0.00\n\nSlope of stress_level when occupation = Sales: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -1.00   1.04   -3.04    1.04    -0.97   0.33\n\nSlope of stress_level when occupation = Medical: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -0.61   0.01   -0.62   -0.59   -81.54   0.00\n\nSlope of stress_level when occupation = Technical: \n\n   Est.   S.E.    2.5%   97.5%   t val.      p\n------- ------ ------- ------- -------- ------\n  -0.79   0.07   -0.93   -0.65   -10.97   0.00\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninteractions::interact_plot(\n  qs_lm_04,\n  pred = stress_level,\n  modx = occupation,\n  interval = TRUE,\n  robust = TRUE,\n  legend.main = \"Occupation\"\n  )\n```\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\nAgain, we do not observe a significant moderation effect of occupation on the relationship between stress level and quality of sleep\n\n### Is the relationship between physical activity and quality of sleep mediated by daily steps?\n\nTo test this, we are going to run 3 regressions:\n\n-   The **total effect** of *physical_activity_level* on *quality_of_sleep.*\n\n-   The effect of *physical_activity_level* on *quality_of_sleep* that is mediated by *daily_steps*, a.k.a. the **indirect effect**\n\n-   The effect of *physical_activity_level* on *quality_of_sleep* that is not mediated by *daily_steps*, a.k.a. the **direct effect**\n\n#### Total effect\n\nWe first determine the total effect by running a regression of *physical_activity_level* on *quality_of_sleep* (without including *daily_steps*):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(quality_of_sleep ~ physical_activity_level, sleep) %>% tidy() %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 6.657 </td>\n   <td style=\"text-align:right;\"> 0.183 </td>\n   <td style=\"text-align:right;\"> 36.307 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 3.792 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe total effect is approximately 0.011, meaning that an increase of one unit in physical activity increases sleep quality by 0.001 units on average, not holding daily steps constant.\n\n#### Mediated/Indirect Effect\n\nThe effect of *physical_activity_level* on *quality_of_sleep* mediated by *daily_steps* can be obtained by multiplying together the effect of *physical_activity_level* on *daily_steps* and the effect of *daily_steps* on *quality_of_sleep*.\n\n##### *1. physical_activity_level* on *daily_steps (a)*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(daily_steps ~ physical_activity_level, sleep) %>% tidy() %>% kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 3265.576 </td>\n   <td style=\"text-align:right;\"> 160.322 </td>\n   <td style=\"text-align:right;\"> 20.369 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 60.017 </td>\n   <td style=\"text-align:right;\"> 2.556 </td>\n   <td style=\"text-align:right;\"> 23.480 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nOne unit increase in *physical_activity_level* increases *daily_steps* by an average of 60 steps\n\n##### *2. daily_steps* on *quality_of_sleep*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(quality_of_sleep ~ daily_steps + physical_activity_level, sleep) %>% tidy() %>% kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.4500816 </td>\n   <td style=\"text-align:right;\"> 0.2609352 </td>\n   <td style=\"text-align:right;\"> 28.551459 </td>\n   <td style=\"text-align:right;\"> 0.00e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> daily_steps </td>\n   <td style=\"text-align:right;\"> -0.0002429 </td>\n   <td style=\"text-align:right;\"> 0.0000580 </td>\n   <td style=\"text-align:right;\"> -4.185867 </td>\n   <td style=\"text-align:right;\"> 3.55e-05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> physical_activity_level </td>\n   <td style=\"text-align:right;\"> 0.0256601 </td>\n   <td style=\"text-align:right;\"> 0.0045064 </td>\n   <td style=\"text-align:right;\"> 5.694113 </td>\n   <td style=\"text-align:right;\"> 0.00e+00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n(a \\* b) = 60.07 \\* -0.00024 = -0.0144\n\n#### Direct Effect\n\nThis is simply the coefficient of physical_activity_level in the above regression = 0.0257\n\nAccording to Zhao *et al.,* what we have here isCompetitive Mediation (Regularly Partial Mediation)\n\nIn the competitive partial mediation hypothesis, it is assumed that the intermediate variable (*daily_steps*) could sometimes increase and at times decrease the relationship between the independent and dependent variables. i.e an \"inconsistent\" model.\n\n![Decision tree for determining mediation](images/Zhao%20et%20al.PNG){fig-align=\"center\"}\n\n# Difference in means\n\n## Research question: are significant differences in the mean sleep quality of both male and female participants\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summary statistics of quality_of_sleep by gender\n\nby(cbind(data=sleep$quality_of_sleep), sleep$gender, psych::describe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nINDICES: Female\n     vars   n mean   sd median trimmed  mad min max range  skew kurtosis   se\ndata    1 185 7.66 1.28      8    7.76 1.48   4   9     5 -0.49    -0.83 0.09\n------------------------------------------------------------ \nINDICES: Male\n     vars   n mean sd median trimmed  mad min max range  skew kurtosis   se\ndata    1 189 6.97  1      7    7.01 1.48   4   9     5 -0.35    -0.59 0.07\n```\n:::\n:::\n\n\nThe mean of female participants is one point higher than males. But is this difference significant?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plotting a violin-errorbar plot to visualise the relationship\nggplot(sleep, aes(gender,quality_of_sleep))+\ngeom_violin() +\nstat_summary(fun.data=\"mean_cl_normal\") + \ntheme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'Hmisc':\n  method       from      \n  vcov.default fit.models\n```\n:::\n\n::: {.cell-output-display}\n![](sleep-disorders_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n\nSince the errorbars do not overlap, we can be fairly confident that the difference is significant. Lets confirm this hunch with a Welsh's t-test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n t.test(quality_of_sleep ~ gender,\n                    data = sleep,\n                    paired = FALSE,\n                    var.equal = FALSE,\n                    conf.level = 0.95,\n                    na.action = na.exclude)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  quality_of_sleep by gender\nt = 5.8593, df = 347.96, p-value = 1.078e-08\nalternative hypothesis: true difference in means between group Female and group Male is not equal to 0\n95 percent confidence interval:\n 0.4627786 0.9304432\nsample estimates:\nmean in group Female   mean in group Male \n            7.664865             6.968254 \n```\n:::\n:::\n\n\nBecause the *p*-value = 1.078e-08 is less than our alpha of .05, we can conclude that the difference between both genders is significant. Also, since the confidence interval expressing the true difference in means does not cross zero, we can be confident that there exists a true difference, with a chance of us being wrong 5% of the time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neffectsize::cohens_d(quality_of_sleep ~ gender, data = sleep) |> \n  knitr::kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Cohens_d </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> CI_low </th>\n   <th style=\"text-align:right;\"> CI_high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 0.815 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n> On average, female participants have better sleep quality (*M* = 7.66, *SE* = 0.09), than those not given a cloak (*M* = 6.97, *SE* = 0.07). Sleep quality is significantly different for both genders: the mean difference, *M* = 0.69, 95% CI \\[0.46, 0.93\\], was significantly different from 0, *t*(347.96) = 5.85, *p* = 01.078e-08. This effect was quite large, d= 0.61\\[0.4, 0.82\\]\n\n# Multinomial Logistic Regression",
    "supporting": [
      "sleep-disorders_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}